<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RuntipiOS - Configuration WiFi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 100%;
            padding: 40px;
        }
        
        .logo {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #333;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 14px;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            color: #333;
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        input, select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .info-box {
            background: #f5f7fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #555;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .success {
            display: none;
            text-align: center;
            color: #10b981;
        }
        
        .error {
            display: none;
            background: #fee;
            border-left: 4px solid #ef4444;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            color: #c00;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect width="64" height="64" rx="12" fill="url(#gradient)"/>
                <path d="M32 16C23.163 16 16 23.163 16 32C16 40.837 23.163 48 32 48C40.837 48 48 40.837 48 32C48 23.163 40.837 16 32 16ZM32 20C38.627 20 44 25.373 44 32C44 38.627 38.627 44 32 44C25.373 44 20 38.627 20 32C20 25.373 25.373 20 32 20Z" fill="white"/>
                <circle cx="32" cy="32" r="6" fill="white"/>
                <defs>
                    <linearGradient id="gradient" x1="0" y1="0" x2="64" y2="64">
                        <stop offset="0%" stop-color="#667eea"/>
                        <stop offset="100%" stop-color="#764ba2"/>
                    </linearGradient>
                </defs>
            </svg>
            <h1>RuntipiOS</h1>
            <p class="subtitle">Configuration WiFi</p>
        </div>
        
        <div class="info-box">
            üëã Bienvenue ! Configurez votre connexion WiFi pour continuer l'installation de Runtipi.
        </div>
        
        <form id="configForm">
            <div class="form-group">
                <label for="wifi_ssid">R√©seau WiFi (SSID)</label>
                <input type="text" id="wifi_ssid" name="wifi_ssid" placeholder="Nom du r√©seau WiFi" required>
            </div>
            
            <div class="form-group">
                <label for="wifi_password">Mot de passe WiFi</label>
                <input type="password" id="wifi_password" name="wifi_password" placeholder="Mot de passe" required>
            </div>
            
            <div class="form-group">
                <label for="wifi_country">Pays (pour r√©glementation WiFi)</label>
                <select id="wifi_country" name="wifi_country" required>
                    <option value="FR">France</option>
                    <option value="US">√âtats-Unis</option>
                    <option value="GB">Royaume-Uni</option>
                    <option value="DE">Allemagne</option>
                    <option value="ES">Espagne</option>
                    <option value="IT">Italie</option>
                    <option value="BE">Belgique</option>
                    <option value="CH">Suisse</option>
                    <option value="CA">Canada</option>
                </select>
            </div>
            
            <button type="submit">Configurer et Red√©marrer</button>
        </form>
        
        <div class="loading">
            <div class="spinner"></div>
            <p>Configuration en cours...<br>Le syst√®me va red√©marrer.</p>
        </div>
        
        <div class="success">
            <h2>‚úÖ Configuration r√©ussie!</h2>
            <p>Le syst√®me red√©marre...</p>
        </div>
        
        <div class="error" id="errorMessage"></div>
    </div>
    
    <script>
        document.getElementById('configForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            
            // Show loading
            document.querySelector('form').style.display = 'none';
            document.querySelector('.loading').style.display = 'block';
            
            try {
                const response = await fetch('/api/configure', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    document.querySelector('.loading').style.display = 'none';
                    document.querySelector('.success').style.display = 'block';
                    
                    // Redirect after 5 seconds
                    setTimeout(() => {
                        window.location.href = 'http://' + data.wifi_ssid + '.local';
                    }, 5000);
                } else {
                    throw new Error('Configuration √©chou√©e');
                }
            } catch (error) {
                document.querySelector('.loading').style.display = 'none';
                document.querySelector('form').style.display = 'block';
                const errorEl = document.getElementById('errorMessage');
                errorEl.textContent = 'Erreur: ' + error.message;
                errorEl.style.display = 'block';
            }
        });
    </script>
</body>
</html>
