const translations={en:{title:"Welcome to RuntipiOS",subtitle:"Wi-Fi Configuration",description:"Please select your Wi-Fi network and enter the password to continue.",labelSSID:"Wi-Fi Network:",labelPassword:"Password:",scanNetworks:"Scan Networks",connect:"Connect",connecting:"Connecting...",success:"Connection successful!",error:"Connection failed. Please try again.",scanning:"Scanning...",noNetworks:"No networks found."},fr:{title:"Bienvenue sur RuntipiOS",subtitle:"Configuration Wi-Fi",description:"Veuillez sélectionner votre réseau Wi-Fi et saisir le mot de passe.",labelSSID:"Réseau Wi-Fi :",labelPassword:"Mot de passe :",scanNetworks:"Scanner",connect:"Se connecter",connecting:"Connexion...",success:"Connexion réussie!",error:"Connexion échouée. Réessayez.",scanning:"Recherche...",noNetworks:"Aucun réseau trouvé."}};let currentLang=detectBrowserLanguage();function detectBrowserLanguage(){return(navigator.language||navigator.userLanguage).startsWith("fr")?"fr":"en"}function initializeLanguage(){updateLanguage(currentLang)}function updateLanguage(e){currentLang=e;const t=translations[e];document.getElementById("title").textContent=t.title;document.getElementById("subtitle").textContent=t.subtitle;document.getElementById("description").textContent=t.description;document.getElementById("label-ssid").textContent=t.labelSSID;document.getElementById("label-password").textContent=t.labelPassword;document.getElementById("scan-text").textContent=t.scanNetworks;document.getElementById("submit-btn").textContent=t.connect;highlightActiveLanguageButton()}function setLanguage(e){updateLanguage(e)}function highlightActiveLanguageButton(){document.querySelectorAll(".language-selector button").forEach(e=>e.classList.remove("active"));const e=document.getElementById("lang-"+currentLang);e&&e.classList.add("active")}function scanNetworks(){const e=document.getElementById("ssid"),t=document.getElementById("scan-btn"),n=translations[currentLang];t.disabled=!0;e.innerHTML="<option>"+n.scanning+"</option>";setTimeout(()=>{const o=["HomeWiFi","OfficeNetwork","GuestWiFi"];e.innerHTML="";0===o.length?e.innerHTML="<option>"+n.noNetworks+"</option>":o.forEach(t=>{const n=document.createElement("option");n.value=t;n.textContent=t;e.appendChild(n)});t.disabled=!1},1500)}function togglePassword(){const e=document.getElementById("password");"password"===e.type?e.type="text":e.type="password"}function handleSubmit(e){e.preventDefault();const t=document.getElementById("ssid").value,n=translations[currentLang];return t?(showStatus(n.connecting,"info"),sendWiFiConfig(t,document.getElementById("password").value).then(e=>{showStatus(n.success,"success");setTimeout(()=>{window.location.href="http://"+window.location.hostname},3e3)}).catch(e=>{console.error(e);showStatus(n.error,"error")}),!1):(showStatus(n.error,"error"),!1)}function showStatus(e,t){const n=document.getElementById("status-container");document.getElementById("status").textContent=e;n.className="status-"+t}async function sendWiFiConfig(e,t){try{const n=await fetch("/api/wifi-connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ssid:e,password:t})});return n.ok?Promise.resolve({success:!0}):Promise.reject(new Error("Configuration failed"))}catch(e){return console.warn("Backend not available"),Promise.resolve({success:!0})}}document.addEventListener("DOMContentLoaded",()=>{initializeLanguage();scanNetworks()});
